corn_OC_Phase1 <- read.csv("C:/Users/skula/Desktop/Uni/MY1_S1/Projekt/corn_OC_Phase1.txt", sep=";")
View(corn_OC_Phase1)
mean(corn_OC_Phase1$Yield[corn_OC_Phase1$Variety == "V2"])
mean(corn_OC_Phase1$Yield[corn_OC_Phase1$Variety == "V3"])
mean(corn_OC_Phase1$Yield[corn_OC_Phase1$Variety == "V2" & corn_OC_Phase1$Fertilizer_type =="F2"]) #płodniejsza V2
mean(corn_OC_Phase1$Yield[corn_OC_Phase1$Variety == "V2" & corn_OC_Phase1$Fertilizer_type =="F1"]) #płodniejsza V2
mean(corn_OC_Phase1$Yield[corn_OC_Phase1$Variety == "V2" & corn_OC_Phase1$Fertilizer_type =="F3"]) #płodniejsza V2
mean(corn_OC_Phase1$Yield[corn_OC_Phase1$Variety == "V2" & corn_OC_Phase1$Fertilizer_type =="F4"]) #płodniejsza V2
mean(corn_OC_Phase1$Yield[corn_OC_Phase1$Variety == "V2" & corn_OC_Phase1$Fertilizer_type =="F5"]) #płodniejsza V2
mean(corn_OC_Phase1$Yield[corn_OC_Phase1$Variety == "V3" & corn_OC_Phase1$Fertilizer_type =="F1"]])
mean(corn_OC_Phase1$Yield[corn_OC_Phase1$Variety == "V3" & corn_OC_Phase1$Fertilizer_type =="F1"])
mean(corn_OC_Phase1$Yield[corn_OC_Phase1$Variety == "V3" & corn_OC_Phase1$Fertilizer_type =="F2"])
mean(corn_OC_Phase1$Yield[corn_OC_Phase1$Variety == "V3" & corn_OC_Phase1$Fertilizer_type =="F3"])
mean(corn_OC_Phase1$Yield[corn_OC_Phase1$Variety == "V3" & corn_OC_Phase1$Fertilizer_type =="F4"])
corn_OC_Phase1 <- read.csv("C:/Users/skula/Desktop/Uni/MY1_S1/Projekt/corn_OC_Phase1.txt", sep=";")
View(corn_OC_Phase1)
mean(corn_OC_Phase1$Yield[corn_OC_Phase1$Variety == "V2" & corn_OC_Phase1$Fertilizer_type =="F1"]) #płodniejsza V2
corn_OC_Phase1 <- read.csv("C:/Users/skula/Desktop/Uni/MY1_S1/Projekt/corn_OC_Phase1.txt", sep=";")
View(corn_OC_Phase1)
mean(corn_OC_Phase1$Yield[corn_OC_Phase1$Variety == "V2" & corn_OC_Phase1$Fertilizer_type =="F1"]) #płodniejsza V2
mean(corn_OC_Phase1$Yield[corn_OC_Phase1$Variety == "V2" & corn_OC_Phase1$Fertilizer_type =="F2"]) #płodniejsza V2
mean(corn_OC_Phase1$Yield[corn_OC_Phase1$Variety == "V2" & corn_OC_Phase1$Fertilizer_type =="F3"]) #płodniejsza V2
mean(corn_OC_Phase1$Yield[corn_OC_Phase1$Variety == "V2" & corn_OC_Phase1$Fertilizer_type =="F4"]) #płodniejsza V2
read.table("corn_OC_FullData.txt")
data(read.table("corn_OC_FullData.txt"))
corn <- read.table("corn_OC_FullData.txt")
View(corn)
corn <- read.csv("corn_OC_FullData.txt")
corn <- read.csv("corn_OC_FullData.txt", sep = ";")
View(corn)
e <- ifelse(is.na(corn$Country), 1, 0)
sum(e)
e <- ifelse(is.na(corn$Variety), 1, 0)
sum(e)
e <- ifelse(is.na(corn$Soli_[H]), 1, 0)
sum(e)
e <- ifelse(is.na(corn$Soli_pH), 1, 0)
sum(e)
e <- is.na(corn)
sum(e)
colSums(is.na(df))
colSums(is.na(dcorn))
colSums(is.na(corn))
install.packages("mice")
corn_imputation <- mice(corn, m = 5)
library(mice)
corn_imputation <- mice(corn, m = 5)
View(corn_imputation)
corn_imputation$data
corn_imputation$loggedEvents
corn_imputation <- mice(corn, m = 5, method = "cart")
corn_imputation$imp$Rainfall
View(corn_imputation)
corn_imputation$imp
corn_imputation$data
library(dplyr)
corn_imputation$data %>%
filter(Country == "France")
corn_imputation$data %>%
filter(Country == "France") %>%
hist(Temperature)
corn_imputation$data %>%
filter(Country == "France") %>%
ggplot(aes(Temperature)) +
geom_hist()
library(ggplot2)
corn_imputation$data %>%
filter(Country == "France") %>%
ggplot(aes(Temperature)) +
geom_hist()
corn_imputation$data %>%
filter(Country == "France") %>%
ggplot(aes(Temperature)) +
geom_histogram()
corn %>%
filter(Country == "France") %>%
ggplot(aes(Temperature)) +
geom_histogram()
corn_imputation$data %>%
filter(Country == "Greece") %>%
ggplot(aes(Temperature)) +
geom_histogram()
corn %>%
filter(Country == "Greece") %>%
ggplot(aes(Temperature)) +
geom_histogram()
colSums(is.na(corn$Temperature))
corn_imputation <- mice(corn, m = 5, method = "rf")
corn_imputation$data
all.variables <- colnames(corn)
View(corn_imputation)
all_variables <- colnames(corn)
# Macierz predykcji
rm(all.variables)
# Macierz predykcji
all_variables <- colnames(corn)
n_variables <- length(all.var)
n_variables <- length(all_variables)
Mlink <- matrix(0, n.variables, n.variables,
dimnames = list(all.variables,all.variables))
Mlink <- matrix(0, n_variables, n_variables,
dimnames = list(all_variables,all_variables))
View(Mlink)
Mlink[c("Temperature", "Rainfall", "Soil_pH"),c("Country")] <- 1
Mlink
rm(list=ls())
corn %>% select(Number == 65) %>%
mutate(Country = "Ireland")
corn <- read.csv("corn_OC_FullData.txt", sep = ";")
corn %>% select(Number == 65) %>%
mutate(Country = "Ireland")
View(corn)
corn %>% select(Number == 65) %>%
mutate(Country = "Ireland")
View(corn)
corn %>% select(Number = 65) %>%
mutate(Country = "Ireland")
corn %>% filer(Number == 65) %>%
mutate(Country = "Ireland")
corn %>% filter(Number == 65) %>%
mutate(Country = "Ireland")
View(corn)
corn <- corn %>% filter(Number == 65) %>%
mutate(Country = "Ireland")
View(corn)
rm(list=ls())
corn <- read.csv("corn_OC_FullData.txt", sep = ";")
corn <- corn %>% select(Number == 65) %>%
mutate(Country = "Ireland")
corn <- corn %>% mutate(Country = if_else(Number == 65, "Ireland" , Country))
View(corn)
corn <- corn %>% mutate(Country = if_else(Number == 194, "Brazil" , Country))
corn <- corn %>% mutate(Country = if_else(Number == 265, "Greece" , Country))
# Macierz predykcji
all_variables <- colnames(corn)
n_variables <- length(all_variables)
Mlink <- matrix(0, n_variables, n_variables,
dimnames = list(all_variables,all_variables))
Mlink[c("Temperature", "Rainfall", "Soil_pH"),c("Country")] <- 1
Mlink
corn_imputation <- mice(corn, m = 5, maxit=50, predictorMatrix = Mlink, method = "pmm")
summary(corn_imputation)
corn_imputation$data
zaimpucone <- corn_imputation$data
View(zaimpucone)
zaimpucone <- corn_imputation$imp
View(zaimpucone)
fit <- with(
imp,
lm(Yield ~ Temperature + Rainfall + Soil_pH + country)
)
fit <- with(
corn_imputation,
lm(Yield ~ Temperature + Rainfall + Soil_pH + country)
)
fit <- with(
corn_imputation,
lm(Yield ~ Temperature + Rainfall + Soil_pH + Country)
)
summary(pooled)
pooled <- pool(fit)
summary(pooled)
corn_imputation <- mice(corn, m = 5, maxit=50, predictorMatrix = Mlink, method = "2l.pmm")
corn %>% mutate(as.factor(Country))
typeof(corn$Country)
corn <- corn %>% mutate(as.factor(Country))
typeof(corn$Country)
corn <- corn %>% mutate(factor(Country))
typeof(corn$Country)
corn$Country <- factor(corn$Country)
stripplot(corn_imputation, Temperature ~ Country)
corn$Country <- factor(corn$Country)
corn_imputation <- mice(corn, m = 5, maxit=50, predictorMatrix = Mlink, method = "pmm")
stripplot(corn_imputation, Temperature ~ Country)
is.na(corn$Soil_pH)
count(is.na(corn$Soil_pH))
19/300
